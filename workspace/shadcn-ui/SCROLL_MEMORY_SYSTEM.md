# ๐ ูุธุงู ุญูุธ ููุถุน ุงูุชูุฑูุฑ (Scroll Memory System)

## ๐ฏ ุงููุฏู
ุญูุธ ูุงุณุชุนุงุฏุฉ ููุถุน ุงูุชูุฑูุฑ ุชููุงุฆูุงู ุนูุฏ ุงูุชููู ุจูู ุงูุตูุญุงุชุ ูุชูููุฑ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ูุงุญุชุฑุงููุฉ.

---

## โจ ุงููููุฒุงุช

### 1๏ธโฃ **ุญูุธ ุชููุงุฆู ุฐูู**
- ูุญูุธ ููุถุน ุงูุชูุฑูุฑ ุฃุซูุงุก ุงูุชุตูุญ ุชููุงุฆูุงู
- ูุณุชุฎุฏู `debounce` (150ms) ูุชุญุณูู ุงูุฃุฏุงุก
- ูุญูุธ ุงูููุถุน ุงูููุงุฆู ุนูุฏ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ

### 2๏ธโฃ **ุงุณุชุนุงุฏุฉ ุฏูููุฉ**
- ูุณุชุนูุฏ ุงูููุถุน ุจุงูุถุจุท ุนูุฏ ุงูุนูุฏุฉ ููุตูุญุฉ
- ูุณุชุฎุฏู `requestAnimationFrame` ูุถูุงู ุฏูุฉ ุงูุงุณุชุนุงุฏุฉ
- ูุนูู ูุน ุฌููุน ุฃููุงุน ุงููุญุชูู (ุซุงุจุช/ุฏููุงูููู)

### 3๏ธโฃ **ุฐุงูุฑุฉ ุซูุงุฆูุฉ ุงููุณุชูู**
- **Memory Cache**: ูููุตูู ุงูุณุฑูุน ูู ููุณ ุงูุฌูุณุฉ
- **SessionStorage**: ููุญูุงุธ ุนูู ุงูุจูุงูุงุช ุนูุฏ ุชุญุฏูุซ ุงูุตูุญุฉ

### 4๏ธโฃ **ุฃุฏุงุก ูุญุณูู**
- ูุง ูุคุซุฑ ุนูู ุณุฑุนุฉ ุงูุชุทุจูู
- ูุณุชุฎุฏู `passive: true` ููุงุณุชูุงุน ููุฃุญุฏุงุซ
- ููุธู ุงูููุงุฑุฏ ุชููุงุฆูุงู

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### ุงููููุงุช ุงูุฑุฆูุณูุฉ

```
src/
โโโ contexts/
โ   โโโ ScrollContext.tsx          # Context ูุฑูุฒู ูุฅุฏุงุฑุฉ ุงูุชูุฑูุฑ
โโโ components/
โ   โโโ Layout.tsx                 # ูููู Layout ุงููุญุฏุซ
โโโ App.tsx                        # ุชุทุจูู ScrollProvider
```

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1. ุงุณุชุฎุฏุงู Layout (ุงูุทุฑููุฉ ุงูููุตู ุจูุง)

```tsx
import Layout from '@/components/Layout';

export default function MyPage() {
  return (
    <Layout pageKey="my-page">
      <div>
        {/* ูุญุชูู ุงูุตูุญุฉ */}
      </div>
    </Layout>
  );
}
```

### 2. ุงุณุชุฎุฏุงู Hook ูุจุงุดุฑุฉ (ููุตูุญุงุช ุงููุฎุตุตุฉ)

```tsx
import { useRef } from 'react';
import { useScrollMemory } from '@/contexts/ScrollContext';

export default function CustomPage() {
  const contentRef = useRef<HTMLDivElement>(null);
  
  // ุชูุนูู ุญูุธ ูุงุณุชุนุงุฏุฉ ุงูุชูุฑูุฑ
  useScrollMemory('custom-page', contentRef);
  
  return (
    <div ref={contentRef} className="overflow-y-auto">
      {/* ุงููุญุชูู */}
    </div>
  );
}
```

### 3. ุงุณุชุฎุฏุงู Context ููุชุญูู ุงููุฏูู

```tsx
import { useScrollContext } from '@/contexts/ScrollContext';

export default function AdvancedPage() {
  const { 
    saveScrollPosition, 
    getScrollPosition, 
    clearScrollPosition 
  } = useScrollContext();
  
  // ุญูุธ ูุฏูู
  const handleSave = () => {
    saveScrollPosition('my-key', 500);
  };
  
  // ุงุณุชุฑุฌุงุน ูุฏูู
  const handleRestore = () => {
    const position = getScrollPosition('my-key');
    console.log('ุงูููุถุน ุงููุญููุธ:', position);
  };
  
  // ูุณุญ ูุฏูู
  const handleClear = () => {
    clearScrollPosition('my-key');
  };
  
  return (
    <div>
      <button onClick={handleSave}>ุญูุธ ุงูููุถุน</button>
      <button onClick={handleRestore}>ุงุณุชุนุงุฏุฉ ุงูููุถุน</button>
      <button onClick={handleClear}>ูุณุญ ุงูููุถุน</button>
    </div>
  );
}
```

---

## ๐ง API Reference

### ScrollProvider

Provider ุฑุฆูุณู ูุฌุจ ูุถุนู ูู ุฌุฐุฑ ุงูุชุทุจูู.

```tsx
<ScrollProvider>
  {children}
</ScrollProvider>
```

### useScrollContext()

Hook ูููุตูู ููุธุงุฆู ุฅุฏุงุฑุฉ ุงูุชูุฑูุฑ.

**ุงูุฏูุงู ุงููุชุงุญุฉ:**

```typescript
interface ScrollContextType {
  // ุญูุธ ููุถุน ุงูุชูุฑูุฑ
  saveScrollPosition: (key: string, position: number) => void;
  
  // ุงุณุชุฑุฌุงุน ููุถุน ุงูุชูุฑูุฑ
  getScrollPosition: (key: string) => number | null;
  
  // ูุณุญ ููุถุน ุชูุฑูุฑ ูุญุฏุฏ
  clearScrollPosition: (key: string) => void;
  
  // ูุณุญ ุฌููุน ููุงุถุน ุงูุชูุฑูุฑ
  clearAllScrollPositions: () => void;
}
```

### useScrollMemory(pageKey, contentRef)

Hook ุชููุงุฆู ูุฅุฏุงุฑุฉ ุงูุชูุฑูุฑ.

**ุงููุนุงููุงุช:**
- `pageKey` (string): ููุชุงุญ ูุฑูุฏ ููุตูุญุฉ
- `contentRef` (RefObject): ูุฑุฌุน ูุนูุตุฑ ุงููุญุชูู ุงููุงุจู ููุชูุฑูุฑ

**ูุซุงู:**
```tsx
const contentRef = useRef<HTMLDivElement>(null);
useScrollMemory('error-management', contentRef);
```

### Layout Component

ูููู ุฌุงูุฒ ูุน ุฅุฏุงุฑุฉ ุชูุฑูุฑ ูุฏูุฌุฉ.

**Props:**
```typescript
interface LayoutProps {
  children: React.ReactNode;
  pageKey?: string; // ุงุฎุชูุงุฑู - ูุณุชุฎุฏู pathname ุงูุชุฑุงุถูุงู
}
```

**ูุซุงู:**
```tsx
<Layout pageKey="custom-page">
  <YourContent />
</Layout>
```

---

## ๐จ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุตูุญุฉ ุฅุฏุงุฑุฉ ุงูุฃุฎุทุงุก

```tsx
import Layout from '@/components/Layout';

export default function ErrorManagement() {
  return (
    <Layout pageKey="error-management">
      <div className="space-y-6">
        <h1>ุฅุฏุงุฑุฉ ุงูุฃุฎุทุงุก</h1>
        {/* ููุงุฆู ุทูููุฉ ูู ุงูุฃุฎุทุงุก */}
        {errors.map(error => (
          <ErrorCard key={error.id} error={error} />
        ))}
      </div>
    </Layout>
  );
}
```

### ูุซุงู 2: ุฌุฏูู ุจูุงูุงุช ูุจูุฑ

```tsx
import Layout from '@/components/Layout';

export default function DataTable() {
  return (
    <Layout pageKey="data-table">
      <div className="space-y-4">
        <h1>ุฌุฏูู ุงูุจูุงูุงุช</h1>
        <table>
          {/* ุขูุงู ุงูุตููู */}
        </table>
      </div>
    </Layout>
  );
}
```

### ูุซุงู 3: ุตูุญุฉ ูุน ุจุญุซ ูููุชุฑุฉ

```tsx
import Layout from '@/components/Layout';
import { useState } from 'react';

export default function SearchPage() {
  const [filters, setFilters] = useState({});
  
  return (
    <Layout pageKey="search-page">
      <div>
        {/* ููุงุชุฑ ุงูุจุญุซ */}
        <Filters onChange={setFilters} />
        
        {/* ุงููุชุงุฆุฌ - ูุญูุธ ุงูููุถุน ุญุชู ุจุนุฏ ุชุทุจูู ุงูููุงุชุฑ */}
        <Results filters={filters} />
      </div>
    </Layout>
  );
}
```

---

## ๐ ููู ูุนูู ุงููุธุงูุ

### 1. ุนูุฏ ุงูุชูุฑูุฑ
```
ุงููุณุชุฎุฏู ูุชูุฑุฑ โ
  โ
handleScroll ููุณุชุฏุนู
  โ
debounce (150ms)
  โ
ุญูุธ ูู Memory Cache
  โ
ุญูุธ ูู SessionStorage
```

### 2. ุนูุฏ ูุบุงุฏุฑุฉ ุงูุตูุญุฉ
```
ุงููุณุชุฎุฏู ููุชูู ูุตูุญุฉ ุฃุฎุฑู
  โ
cleanup function
  โ
ุญูุธ ุงูููุถุน ุงูููุงุฆู
  โ
ุงูุงุญุชูุงุธ ุจุงูุจูุงูุงุช ูู SessionStorage
```

### 3. ุนูุฏ ุงูุนูุฏุฉ ููุตูุญุฉ
```
ุงููุณุชุฎุฏู ูุนูุฏ ููุตูุญุฉ
  โ
useEffect ููุณุชุฏุนู
  โ
ุงูุจุญุซ ูู Memory Cache
  โ
ุฅุฐุง ุบูุฑ ููุฌูุฏ โ ุงูุจุญุซ ูู SessionStorage
  โ
requestAnimationFrame ร 2
  โ
ุงุณุชุนุงุฏุฉ ุงูููุถุน ุจุฏูุฉ
```

---

## ๐ ููุงุฑูุฉ ุงูุฃุฏุงุก

### ูุจู ุงููุธุงู
- โ ูู ุตูุญุฉ ุชุจุฏุฃ ูู ุงูุฃุนูู
- โ ุงููุณุชุฎุฏู ูููุฏ ููุงูู
- โ ุชุฌุฑุจุฉ ูุฒุนุฌุฉ ูู ุงูุฌุฏุงูู ุงูุทูููุฉ
- โ ุฅุนุงุฏุฉ ุจุญุซ ุจุนุฏ ูู ุชููู

### ุจุนุฏ ุงููุธุงู
- โ ุงุณุชุนุงุฏุฉ ุชููุงุฆูุฉ ููููุถุน
- โ ุงููุณุชุฎุฏู ูุฌุฏ ููุณู ูู ููุณ ุงูููุงู
- โ ุชุฌุฑุจุฉ ุณูุณุฉ ูุงุญุชุฑุงููุฉ
- โ ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุงูุจุญุซ

---

## ๐ ุงูุตูุญุงุช ุงููุณุชููุฏุฉ

### ุงูุตูุญุงุช ุงูุญุงููุฉ ุงูุชู ุชุณุชุฎุฏู ุงููุธุงู:
1. โ **ุฅุฏุงุฑุฉ ุงูุฃุฎุทุงุก** (`/error-management`)
2. ๐ **ุฅุฏุงุฑุฉ ุงูููุงู** (ูููู ุชูุนูููุง)
3. ๐ **ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน** (ูููู ุชูุนูููุง)
4. ๐ **ุงูุชุญูููุงุช ูุงูุชูุงุฑูุฑ** (ูููู ุชูุนูููุง)
5. ๐ **ุงููุธุงู ุงููุญุงุณุจู** (ูููู ุชูุนูููุง)

### ูุชูุนูู ุงููุธุงู ูู ุฃู ุตูุญุฉ:
ุจุจุณุงุทุฉ ุงุณุชุจุฏู ุงูู wrapper ุงูุญุงูู ุจู `<Layout>`:

```tsx
// ูุจู
<div className="container">
  {content}
</div>

// ุจุนุฏ
<Layout pageKey="unique-page-name">
  {content}
</Layout>
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: ูุง ูุชู ุญูุธ ุงูููุถุน
**ุงูุญู:**
1. ุชุฃูุฏ ูู ูุฌูุฏ `<ScrollProvider>` ูู `App.tsx`
2. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู `Layout` ุฃู `useScrollMemory`
3. ุชุญูู ูู Console ููุฑุณุงุฆู ุงูุชุดุฎูุตูุฉ

### ุงููุดููุฉ: ุงูููุถุน ุบูุฑ ุฏููู
**ุงูุญู:**
1. ุชุฃูุฏ ูู ุฃู ุงููุญุชูู ูุญููู ูุจู ุงุณุชุนุงุฏุฉ ุงูููุถุน
2. ุงุณุชุฎุฏู `requestAnimationFrame` ุฅุฐุง ููุช ุชุณุชุฎุฏู Hook ูุฏูู
3. ุชุญูู ูู ุนุฏู ูุฌูุฏ CSS transitions ุชุชุนุงุฑุถ

### ุงููุดููุฉ: ุจุทุก ูู ุงูุฃุฏุงุก
**ุงูุญู:**
1. ุงููุธุงู ูุณุชุฎุฏู debounce ุงูุชุฑุงุถูุงู (150ms)
2. ุชุฃูุฏ ูู ุงุณุชุฎุฏุงู `passive: true` ูู event listeners
3. ุชุฌูุจ ุญูุธ ุงูููุถุน ูู ูู frame

---

## ๐ ููุงุญุธุงุช ูููุฉ

### 1. SessionStorage vs LocalStorage
- โ **SessionStorage**: ูููุณุญ ุนูุฏ ุฅุบูุงู ุงูุชุจููุจ (ูุซุงูู ูุฌูุณุฉ ุงูุนูู)
- โ **LocalStorage**: ูุจูู ููุฃุจุฏ (ูุฏ ูุณุจุจ ูุดุงูู)

### 2. Page Keys
- ุงุณุชุฎุฏู ููุงุชูุญ ูุฑูุฏุฉ ููู ุตูุญุฉ
- ุฅุฐุง ูู ุชุญุฏุฏ `pageKey`ุ ุณููุณุชุฎุฏู `pathname` ุชููุงุฆูุงู
- ููุตูุญุงุช ุงูุฏููุงููููุฉ: `pageKey="user-${userId}"`

### 3. Memory Cache
- ูุณุฑูุน ุงููุตูู ูู ููุณ ุงูุฌูุณุฉ
- ูููุณุญ ุนูุฏ ุชุญุฏูุซ ุงูุตูุญุฉ (F5)
- ูุนูู ูุทุจูุฉ ุฃููู ูุจู SessionStorage

---

## ๐ ุฃูุถู ุงูููุงุฑุณุงุช

### โ ุงูุนู:
- ุงุณุชุฎุฏู `Layout` ููุตูุญุงุช ุงูุจุณูุทุฉ
- ุงุณุชุฎุฏู `useScrollMemory` ููุตูุญุงุช ุงููุฎุตุตุฉ
- ุญุฏุฏ `pageKey` ูุฑูุฏ ููู ุตูุญุฉ
- ุงุณุชุฎุฏู ุงูุชูุธูู ุงููุฏูู ุนูุฏ ุงูุญุงุฌุฉ

### โ ูุง ุชูุนู:
- ูุง ุชุญูุธ ุงูููุถุน ูู ูู event
- ูุง ุชุณุชุฎุฏู ููุณ `pageKey` ูุตูุญุงุช ูุฎุชููุฉ
- ูุง ุชุนุทู `passive: true` ูู event listeners
- ูุง ุชุญูุธ ุจูุงูุงุช ุญุณุงุณุฉ ูู ุงูููุถุน

---

## ๐ฎ ุงูุชุทููุฑ ุงููุณุชูุจูู

### ููุฒุงุช ูุญุชููุฉ:
1. ๐ ุฏุนู history.state ููุชูุงูู ูุน browser history
2. ๐ฑ ุชุญุณููุงุช ููุดุงุดุงุช ุงูุตุบูุฑุฉ
3. ๐ฏ ุฏุนู scroll positions ูุชุนุฏุฏุฉ ูู ููุณ ุงูุตูุญุฉ
4. ๐พ ุฎูุงุฑ ุญูุธ ูู localStorage ููุตูุญุงุช ุงููููุฉ
5. ๐ Analytics ูุชุชุจุน ุณููู ุงูุชูุฑูุฑ

---

## ๐ ุงูุฏุนู

ูููุฒูุฏ ูู ุงููุนูููุงุช ุฃู ุงููุณุงุนุฏุฉ:
- ุฑุงุฌุน ุงูููุฏ ูู `src/contexts/ScrollContext.tsx`
- ุชุญูู ูู ุงูุฃูุซูุฉ ูู `src/components/Layout.tsx`
- ุงุณุชุฎุฏู Console Logs ููุชุดุฎูุต (ููุนููุฉ ุงูุชุฑุงุถูุงู)

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 2 ุฏูุณูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 1.0.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ
