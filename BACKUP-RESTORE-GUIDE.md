# ๐ ุฏููู ุงููุณุฎ ุงูุงุญุชูุงุทู ูุงูุงุณุชุฑุฌุงุน
## ูุธุงู Backup & Restore ุงููุญุฏูุซ

---

## ๐ฏ ุงูุชุญุฏูุซุงุช ุงูุฌุฏูุฏุฉ

### โ ูุง ุชู ุชุญุณููู:

1. **ุงููุณุงุฑุงุช ุงูุฏููุงููููุฉ**
   - ูุณุชุฎุฏู ุงููุณุงุฑ ุงูุญูููู ูููุดุฑูุน ุชููุงุฆูุงู
   - ุฏุนู ูุงูู ูุจูุฆุฉ ุงููุชุตูุญ (IndexedDB/localStorage)
   - ุฏุนู ูุงูู ูุจูุฆุฉ Node.js

2. **ูุงุฌูุฉ ูุญุณููุฉ**
   - ุฅุญุตุงุฆูุงุช ุดุงููุฉ ูููุณุฎ
   - ุฃุฒุฑุงุฑ ุชุตุฏูุฑ/ุงุณุชูุฑุงุฏ/ุญุฐู
   - ุฑุณุงุฆู ูุงุถุญุฉ ููุนูููุงุช
   - ุชุฃููุฏุงุช ุฃูุงู

3. **ูุธุงุฆู ุฌุฏูุฏุฉ**
   - โ ุชุตุฏูุฑ ุงููุณุฎุฉ ูููู
   - โ ุงุณุชูุฑุงุฏ ูุณุฎุฉ ูู ููู
   - โ ุญุฐู ูุณุฎุฉ ูุญุฏุฏุฉ
   - โ ุชูุธูู ุงููุณุฎ ุงููุฏููุฉ
   - โ ุฅุญุตุงุฆูุงุช ููุตูุฉ

---

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### 1๏ธโฃ ุงููุตูู ููุธุงู ุงููุณุฎ

```
http://localhost/security
```

ุซู ุงุฎุชุฑ ุชุจููุจ **๐พ ุงููุณุฎ**

---

### 2๏ธโฃ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ

#### ูู ููุญุฉ ุงูุชุญูู:
```typescript
// ุงุถุบุท ุนูู ุฒุฑ "๐พ ูุณุฎุฉ ุงุญุชูุงุทูุฉ"
```

#### ุจุฑูุฌูุงู:
```typescript
import { backupManager } from '@/lib/data-protection';

const backup = await backupManager.createBackup('full', userId);

// ุงููุชูุฌุฉ:
{
  id: "backup_1701612345678",
  timestamp: Date,
  type: "full",
  size: 245632,
  encrypted: true,
  fileName: "backup_full_2025-12-03_1701612345678.enc",
  location: "indexeddb://backups/full",
  checksum: "abc123..."
}
```

**ููุงุญุธุงุช:**
- โ ูุชู ุชุดููุฑ ุงูุจูุงูุงุช ุชููุงุฆูุงู
- โ ูุญุณุจ checksum ููุชุญูู ูู ุงูุณูุงูุฉ
- โ ูุญูุธ ูู localStorage ุจุดูู ูุคูุช
- โ ูุณุฌู ูู console ุฌููุน ุงูุชูุงุตูู

---

### 3๏ธโฃ ุงุณุชุฑุฌุงุน ูุณุฎุฉ ุงุญุชูุงุทูุฉ

#### ูู ููุญุฉ ุงูุชุญูู:
```typescript
// ุงุถุบุท ุนูู ุฒุฑ "๐" ุจุฌุงูุจ ุงููุณุฎุฉ ุงููุทููุจุฉ
// ุณุชุธูุฑ ุฑุณุงูุฉ ุชุฃููุฏ
// ุจุนุฏ ุงูุชุฃููุฏุ ุณูุชู ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช
```

#### ุจุฑูุฌูุงู:
```typescript
import { backupManager } from '@/lib/data-protection';

const success = await backupManager.restoreBackup(backupId);

if (success) {
  console.log('โ ุชู ุงูุงุณุชุฑุฌุงุน ุจูุฌุงุญ');
  // ุณูุชู ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ุชููุงุฆูุงู
}
```

**ุฎุทูุงุช ุงูุงุณุชุฑุฌุงุน:**
1. ๐ ุชุญููู ุงูุจูุงูุงุช ุงููุดูุฑุฉ
2. ๐ ุงูุชุญูู ูู checksum
3. ๐ ูู ุงูุชุดููุฑ
4. ๐ ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช ุฅูู localStorage
5. ๐ ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ

**ุงูุณุฌู ูู Console:**
```
๐ ุจุฏุก ุงุณุชุฑุฌุงุน ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ: backup_full_2025-12-03_1701612345678.enc
๐ ูู ุงููููุน: indexeddb://backups/full/backup_full_2025-12-03_1701612345678.enc
๐ ุชู ุชุญููู ุงููุณุฎุฉ ูู ุงูุชุฎุฒูู: backup_1701612345678
๐ ุงูุชุญูู ูู ุณูุงูุฉ ุงููุณุฎุฉ...
โ ุงููุณุฎุฉ ุณูููุฉุ ุฌุงุฑู ูู ุงูุชุดููุฑ...
๐ ุชู ูู ุงูุชุดููุฑุ ุฌุงุฑู ุงุณุชุฑุฌุงุน ุงูุจูุงูุงุช...
โ ุชู ุงุณุชุฑุฌุงุน 47 ุนูุตุฑ ุจูุฌุงุญ
๐ ุชุงุฑูุฎ ุงููุณุฎุฉ: 3/12/2025 10:30:45 ุต
๐ ุณูุชู ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ูุชุทุจูู ุงูุชุบููุฑุงุช...
```

---

### 4๏ธโฃ ุชุตุฏูุฑ ูุณุฎุฉ ุงุญุชูุงุทูุฉ (ุชุญููู ููู)

#### ูู ููุญุฉ ุงูุชุญูู:
```typescript
// ุงุถุบุท ุนูู ุฒุฑ "โฌ" (Download)
// ุณูุชู ุชุญููู ุงูููู: backup_full_2025-12-03_1701612345678.enc
```

#### ุจุฑูุฌูุงู:
```typescript
import { backupManager } from '@/lib/data-protection';

const blob = await backupManager.exportBackup(backupId);

if (blob) {
  // ุฅูุดุงุก ุฑุงุจุท ุชุญููู
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'backup.enc';
  a.click();
}
```

**ุงูุงุณุชุฎุฏุงูุงุช:**
- ๐พ ุญูุธ ูุณุฎุฉ ุนูู ุงููุฑุต ุงูุตูุจ
- โ๏ธ ุฑูุน ุงููุณุฎุฉ ุฅูู ุงูุณุญุงุจุฉ
- ๐ง ุฅุฑุณุงู ุงููุณุฎุฉ ุจุงูุจุฑูุฏ
- ๐ฟ ูุณุฎ ุงุญุชูุงุทู ุฎุงุฑุฌู

---

### 5๏ธโฃ ุงุณุชูุฑุงุฏ ูุณุฎุฉ ุงุญุชูุงุทูุฉ (ูู ููู)

#### ูู ููุญุฉ ุงูุชุญูู:
```typescript
// ุงุถุบุท ุนูู ุฒุฑ "โฌ ุงุณุชูุฑุงุฏ"
// ุงุฎุชุฑ ุงูููู: backup_full_2025-12-03_1701612345678.enc
// ุณูุชู ุงุณุชูุฑุงุฏ ุงููุณุฎุฉ ูุญูุธูุง ูู ุงููุงุฆูุฉ
```

#### ุจุฑูุฌูุงู:
```typescript
import { backupManager } from '@/lib/data-protection';

// ูู input file
const file = event.target.files[0];

const backup = await backupManager.importBackup(file, userId);

if (backup) {
  console.log('โ ุชู ุงูุงุณุชูุฑุงุฏ:', backup.fileName);
}
```

**ููุงุญุธุงุช:**
- โ ูุชุญูู ูู ุณูุงูุฉ ุงูููู
- โ ูุญุณุจ checksum ุฌุฏูุฏ
- โ ูุถูู ุฅูู ูุงุฆูุฉ ุงููุณุฎ
- โ ูููู ุงุณุชุฑุฌุงุนู ูุจุงุดุฑุฉ

---

### 6๏ธโฃ ุญุฐู ูุณุฎุฉ ุงุญุชูุงุทูุฉ

#### ูู ููุญุฉ ุงูุชุญูู:
```typescript
// ุงุถุบุท ุนูู ุฒุฑ "๐" (Delete)
// ุณุชุธูุฑ ุฑุณุงูุฉ ุชุฃููุฏ
```

#### ุจุฑูุฌูุงู:
```typescript
// ุญุฐู ูู ุงููุงุฆูุฉ
const backups = backupManager.getBackups();
const filteredBackups = backups.filter(b => b.id !== backupId);
```

---

### 7๏ธโฃ ุชูุธูู ุงููุณุฎ ุงููุฏููุฉ

#### ูู ููุญุฉ ุงูุชุญูู:
```typescript
// ุงุถุบุท ุนูู ุฒุฑ "๐ ุชูุธูู ุงููุฏููุฉ"
// ุณูุญุฐู ุฌููุน ุงููุณุฎ ุงูุฃูุฏู ูู 30 ููู
```

#### ุจุฑูุฌูุงู:
```typescript
import { backupManager } from '@/lib/data-protection';

const deletedCount = backupManager.cleanOldBackups(30);
console.log(`ุชู ุญุฐู ${deletedCount} ูุณุฎุฉ ูุฏููุฉ`);
```

---

### 8๏ธโฃ ุนุฑุถ ุงูุฅุญุตุงุฆูุงุช

#### ุจุฑูุฌูุงู:
```typescript
import { backupManager } from '@/lib/data-protection';

const stats = backupManager.getBackupStats();

console.log(stats);
// ุงููุชูุฌุฉ:
{
  total: 15,
  totalSize: 3680256,
  byType: {
    full: 10,
    incremental: 5
  },
  oldest: Date(2025-11-01),
  newest: Date(2025-12-03)
}
```

---

## ๐ ุจููุฉ ุงูุจูุงูุงุช

### BackupMetadata
```typescript
{
  id: string;              // ูุนุฑู ูุฑูุฏ
  timestamp: Date;         // ุชุงุฑูุฎ ุงูุฅูุดุงุก
  type: 'full' | 'incremental';
  size: number;           // ุงูุญุฌู ุจุงูุจุงูุช
  encrypted: boolean;     // ูุดูุฑุฉุ
  createdBy: string;      // ูู ุฃูุดุฃูุง
  location: string;       // ุงููุณุงุฑ
  fileName: string;       // ุงุณู ุงูููู
  checksum: string;       // ููุชุญูู ูู ุงูุณูุงูุฉ
}
```

### ูุญุชูู ุงููุณุฎุฉ ุงูุงุญุชูุงุทูุฉ
```typescript
{
  metadata: {
    version: "1.0",
    createdAt: "2025-12-03T10:30:45.123Z",
    platform: "browser"
  },
  users: "...",
  tasks: "...",
  revenues: "...",
  points: "...",
  settings: "...",
  // ... ุฌููุน ููุงุชูุญ localStorage
}
```

---

## ๐ ุงูุฃูุงู

### ุงูุชุดููุฑ
- **ุงูุฎูุงุฑุฒููุฉ:** AES-256 (ูุญุงูู ุญุงููุงู)
- **ุงูููุชุงุญ:** ูููููุฏ ุชููุงุฆูุงู ูููุญูุธ ูู localStorage
- **ุงูุชุญูู:** checksum ููู ูุณุฎุฉ

### ุงูุตูุงุญูุงุช
- โ ุงููุฏูุฑ ููุท ูุณุชุทูุน ุฅูุดุงุก/ุงุณุชุฑุฌุงุน ุงููุณุฎ
- โ ุณุฌู ุชุฏููู ููู ุนูููุฉ
- โ ุชุฃููุฏุงุช ูุจู ุงูุญุฐู/ุงูุงุณุชุฑุฌุงุน

### ุฃูุถู ุงูููุงุฑุณุงุช
1. **ูุณุฎ ุงุญุชูุงุทูุฉ ุฏูุฑูุฉ:**
   - ููููุฉ: ูุณุฎุฉ ุชุฒุงูุฏูุฉ
   - ุฃุณุจูุนูุฉ: ูุณุฎุฉ ูุงููุฉ
   - ุดูุฑูุฉ: ูุณุฎุฉ ูุงููุฉ ุฎุงุฑุฌูุฉ

2. **ุงูุชุฎุฒูู ุงูุขูู:**
   - ุงุญูุธ ุงููุณุฎ ูู ุฃูุงูู ูุชุนุฏุฏุฉ
   - ุงุณุชุฎุฏู ุงูุชุดููุฑ ุฏุงุฆูุงู
   - ูุง ุชุดุงุฑู ูููุงุช ุงููุณุฎ

3. **ุงูุงุฎุชุจุงุฑ:**
   - ุงุฎุชุจุฑ ุงูุงุณุชุฑุฌุงุน ุฏูุฑูุงู
   - ุชุญูู ูู ุณูุงูุฉ ุงููุณุฎ
   - ุงุญูุธ ูุณุฎุฉ ุฎุงุฑุฌ ุงูุฎุงุฏู

---

## ๐ฏ ุณููุงุฑูููุงุช ุงูุงุณุชุฎุฏุงู

### 1. ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููููู
```typescript
// ูู cron job ูููู
const backup = await backupManager.createBackup('incremental', 'system');
await backupManager.exportBackup(backup.id);
// ุฑูุน ุงูููู ุฅูู S3 ุฃู Dropbox
```

### 2. ูุจู ุงูุชุญุฏูุซุงุช ุงููุจูุฑุฉ
```typescript
// ูุจู ูุดุฑ ุชุญุฏูุซ
console.log('๐ฆ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ูุจู ุงูุชุญุฏูุซ...');
const backup = await backupManager.createBackup('full', adminId);
console.log(`โ ุงููุณุฎุฉ ุฌุงูุฒุฉ: ${backup.fileName}`);
// ุงูุขู ูููู ูุดุฑ ุงูุชุญุฏูุซ ุจุฃูุงู
```

### 3. ุงุณุชุนุงุฏุฉ ุจุนุฏ ุฎุทุฃ
```typescript
// ุฅุฐุง ุญุฏุซ ุฎุทุฃ
console.log('โ๏ธ ุฎุทุฃ ุญุฑุฌ! ุงุณุชุฑุฌุงุน ุขุฎุฑ ูุณุฎุฉ...');
const backups = backupManager.getBackups();
const lastBackup = backups[0];
await backupManager.restoreBackup(lastBackup.id);
```

### 4. ููู ุงูุจูุงูุงุช ูุจูุฆุฉ ุฌุฏูุฏุฉ
```typescript
// ูู ุงูุจูุฆุฉ ุงููุฏููุฉ
const backup = await backupManager.createBackup('full', adminId);
const blob = await backupManager.exportBackup(backup.id);
// ุชุญููู ุงูููู

// ูู ุงูุจูุฆุฉ ุงูุฌุฏูุฏุฉ
const file = /* ุฑูุน ุงูููู */;
const imported = await backupManager.importBackup(file, adminId);
await backupManager.restoreBackup(imported.id);
```

---

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดููุฉ: "ูุณุงุญุฉ ุงูุชุฎุฒูู ููุชูุฆุฉ"
```typescript
// ุงูุญู 1: ุญุฐู ุงููุณุฎ ุงููุฏููุฉ
backupManager.cleanOldBackups(7);

// ุงูุญู 2: ุชุตุฏูุฑ ูุญุฐู
for (const backup of backups) {
  await backupManager.exportBackup(backup.id);
  // ุญุฐู ุจุนุฏ ุงูุชุตุฏูุฑ
}
```

### ุงููุดููุฉ: "ุงููุณุฎุฉ ุชุงููุฉ"
```typescript
// ุงูุชุญูู ูู checksum
const backup = backupManager.getBackupInfo(backupId);
console.log('Checksum:', backup.checksum);

// ูุญุงููุฉ ุชุตุฏูุฑ ูุฅุนุงุฏุฉ ุงุณุชูุฑุงุฏ
const blob = await backupManager.exportBackup(backupId);
// ุญูุธ ุงูููู ูุฅุนุงุฏุฉ ุฑูุนู
```

### ุงููุดููุฉ: "ูุดู ุงูุงุณุชุฑุฌุงุน"
```typescript
// ุงูุชุญูู ูู console
// ุณุชุฌุฏ ุงูุณุจุจ ุงูููุตู

// ุชุฌุฑุจุฉ ูุณุฎุฉ ุฃุฎุฑู
const backups = backupManager.getBackups();
for (const backup of backups) {
  console.log(`ูุญุงููุฉ: ${backup.fileName}`);
  const success = await backupManager.restoreBackup(backup.id);
  if (success) break;
}
```

---

## ๐ ููุงุญุธุงุช ูููุฉ

### ูููุทูุฑูู:
- โ๏ธ ุงูุชุดููุฑ ุงูุญุงูู **ูุจุณุท ููุชูุถูุญ**
- โ๏ธ ูู ุงูุฅูุชุงุฌุ ุงุณุชุฎุฏู **crypto-js** ุฃู **Web Crypto API**
- โ๏ธ localStorage ูุญุฏูุฏ (~5-10MB)
- โ๏ธ ูููุดุงุฑูุน ุงููุจูุฑุฉุ ุงุณุชุฎุฏู **IndexedDB**

### ูููุณุคูููู:
- โ ุงุญูุธ ูุณุฎุฉ ุฎุงุฑุฌูุฉ ูู ุฃุณุจูุน
- โ ุงุฎุชุจุฑ ุงูุงุณุชุฑุฌุงุน ุดูุฑูุงู
- โ ูุง ุชุญุฐู ุงููุณุฎ ุงููุฏููุฉ ุฅูุง ุจุนุฏ ุงูุชุฃูุฏ
- โ ูุซูู ุนูููุฉ ุงููุณุฎ ูุงูุงุณุชุฑุฌุงุน

### ูููุณุชุฎุฏููู:
- ๐ฑ ุงููุณุฎ ุงูุงุญุชูุงุทูุฉ ูููุฏูุฑ ููุท
- ๐ ูุง ุชุดุงุฑู ูููุงุช ุงููุณุฎ
- โ๏ธ ุงูุงุณุชุฑุฌุงุน ูุณุชุจุฏู ุฌููุน ุงูุจูุงูุงุช
- ๐ ุณูุชู ุฅุนุงุฏุฉ ุชุญููู ุงูุตูุญุฉ ุจุนุฏ ุงูุงุณุชุฑุฌุงุน

---

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ูุณุฎ ุงุญุชูุงุทู ูููู ุชููุงุฆู
```typescript
// ูู service worker ุฃู scheduled job
setInterval(async () => {
  const hour = new Date().getHours();
  
  if (hour === 2) { // 2 ุตุจุงุญุงู
    console.log('โฐ ููุช ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููููู');
    
    try {
      const backup = await backupManager.createBackup('incremental', 'system');
      const blob = await backupManager.exportBackup(backup.id);
      
      // ุฑูุน ุฅูู ุงูุณุญุงุจุฉ
      await uploadToCloud(blob, backup.fileName);
      
      console.log('โ ุชู ุงููุณุฎ ุงูุงุญุชูุงุทู ุงููููู');
    } catch (error) {
      console.error('โ ูุดู ุงููุณุฎ ุงููููู:', error);
      // ุฅุฑุณุงู ุชูุจูู ูููุฏูุฑ
    }
  }
}, 60 * 60 * 1000); // ูู ุณุงุนุฉ
```

### ูุซุงู 2: ูุณุฎ ูุจู ุงูุนูููุงุช ุงูุญุฑุฌุฉ
```typescript
async function deleteAllRevenues() {
  // ูุณุฎ ุงุญุชูุงุทู ุฃููุงู
  console.log('๐ฆ ุฅูุดุงุก ูุณุฎุฉ ุงุญุชูุงุทูุฉ ุฃูุงู...');
  const backup = await backupManager.createBackup('full', currentUserId);
  
  try {
    // ุชูููุฐ ุงูุนูููุฉ ุงูุฎุทุฑุฉ
    await performDangerousOperation();
    console.log('โ ูุฌุญุช ุงูุนูููุฉ');
  } catch (error) {
    // ุงุณุชุฑุฌุงุน ุชููุงุฆู ุนูุฏ ุงููุดู
    console.log('โ๏ธ ูุดูุช ุงูุนูููุฉ! ุงุณุชุฑุฌุงุน ุงููุณุฎุฉ...');
    await backupManager.restoreBackup(backup.id);
  }
}
```

### ูุซุงู 3: ูุฑุงูุจุฉ ุญุฌู ุงููุณุฎ
```typescript
function monitorBackupSize() {
  const stats = backupManager.getBackupStats();
  const sizeMB = stats.totalSize / (1024 * 1024);
  
  console.log(`๐ ุญุฌู ุงููุณุฎ: ${sizeMB.toFixed(2)} MB`);
  
  if (sizeMB > 50) {
    console.warn('โ๏ธ ุงููุณุฎ ุชุณุชููู ูุณุงุญุฉ ูุจูุฑุฉ!');
    
    // ุญุฐู ุงููุณุฎ ุงูุฃูุฏู ูู 30 ููู
    const deleted = backupManager.cleanOldBackups(30);
    console.log(`๐๏ธ ุชู ุญุฐู ${deleted} ูุณุฎุฉ ูุฏููุฉ`);
  }
}
```

---

## ๐ ุฎุงุฑุทุฉ ุทุฑูู ุงูุชุทููุฑ ุงููุณุชูุจูู

### ูุฑูุจุงู:
- [ ] ุฏุนู ูุงุนุฏุฉ ุจูุงูุงุช PostgreSQL/MySQL
- [ ] ูุณุฎ ุชุฒุงูุฏูุฉ ุญููููุฉ (diff-based)
- [ ] ุถุบุท ุงูุจูุงูุงุช (gzip)
- [ ] ูุณุฎ ูุชุนุฏุฏุฉ ุงูููุงูุน

### ูุชูุณุท ุงูุฃูุฏ:
- [ ] ุฌุฏููุฉ ุชููุงุฆูุฉ ูุชูุฏูุฉ
- [ ] ุชูุงูู ูุน AWS S3
- [ ] ุชุดููุฑ end-to-end ุญูููู
- [ ] ูุณุฎ ุงูุชูุงุฆูุฉ (ูุฌุฏุงูู ูุญุฏุฏุฉ)

### ุทููู ุงูุฃูุฏ:
- [ ] ูุณุฎ ููุฒุนุฉ (distributed)
- [ ] ุงุณุชุฑุฌุงุน point-in-time
- [ ] ูุณุฎ ุงุญุชูุงุทูุฉ ุชุฏุฑูุฌูุฉ
- [ ] ุชุทุจูู ุฌูุงู ููุฅุฏุงุฑุฉ

---

## ๐ ุงูุฏุนู

ููุฃุณุฆูุฉ ูุงููุณุงุนุฏุฉ:
- ๐ง ุงูุจุฑูุฏ: backup@charity.org
- ๐ฑ ุงูุฌูุงู: [ูููุฃ ูุงุญูุงู]
- ๐ ุงูุชูุซูู: /docs/backup

---

**ุชุญุฏูุซ:** 3 ุฏูุณูุจุฑ 2025  
**ุงูุฅุตุฏุงุฑ:** 2.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ
